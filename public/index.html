<!doctype html>
<html>
   <head>
      <meta charset="utf-8" />
      <title>MazeBattles.com | Multiplayer Maze Competition</title>

<link href="https://fonts.googleapis.com/css?family=Cormorant+Garamond:400,700" rel="stylesheet">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
      <link href="main.css" rel="stylesheet">

      <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.3.1.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.6.0/p5.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.4/socket.io.js"></script>

      <script src="js/connect.js"></script> <!-- Script that connects to the node.js server -->
      <script src="queue.js"></script> 
      <script src="game.js"></script> <!-- Handles server requests and sends data to servers (logic processing) -->
   </head>
   <body>

      <nav>
          
      </nav>

      <!-- Implement social media buttons plus theme, similar to bouncyballs.org -->

      <div id="content">
         <div id="game-wrapper">
            <div id="canvas-wrapper">
            </div>
         </div>

        <div class="whitespace"></div>  

         <div id="text-container">
               <div id="play-wrapper">
                  <button id="one-on-one">
                     One-on-One
                  </button>
                  <button id="single-player">
                     Single-player
                  </button>
               </div>

               <div id="one-on-one-wrapper">
                  <button id="join">
                     Join
                  </button>
                  <button id="invite">
                     Invite
                  </button>
               </div>
            </div>

            <div id="invite-menu">
              Generating room code...
            </div>

            <div id="game-panel">

            </div>

            <div id="join-menu">
              <input type="text" placeholder="room code (press enter / return to join)" id="room-code" />
            </div>
      </div>
      
      <script type="text/javascript">
        $("#content").fadeIn();

        // Retrieve the 

        $("#one-on-one").click(function() {
          // Display the new One-on-One layout
          // Two buttons: Joining a match and Inviting others to the match
          // Fade out play-wrapper, and fade in the one-on-one-wrapper
          $("#play-wrapper").addClass("animated fadeOutLeft");

          // Make the one-on-one-wrapper visible
          $("#play-wrapper").hide();
          $("#one-on-one-wrapper").show();

          $("#one-on-one-wrapper").addClass("animated fadeInRight");

          $("#join").click(function() {
            $("#one-on-one-wrapper").hide();
            
            $("#one-on-one-wrapper").removeClass("animated fadeInRight");
            $("#one-on-one-wrapper").addClass("animated fadeOutLeft");
          });

          $("#invite").click(function() {
            $("#one-on-one-wrapper").removeClass("animated fadeInRight");
            $("#one-on-one-wrapper").addClass("animated fadeOutLeft");

            // Make the invite sub menu visible
            $("#text-container").hide();
            $("#invite-menu").show();
            $("#invite-menu").addClass("animated fadeInRight");

            socket.emit("invite", true);
          });

          $("#join").click(function() {
            $("#join-menu").show();
            $("#join-menu").addClass("animated fadeInRight");

            var roomCode = document.getElementById("room-code");

            roomCode.addEventListener("keyup", function(event) {
              event.preventDefault();

              if (event.keyCode === 13) { // The user pressed the enter / return key
                console.log("user inputted room code");

                // Begin verification process
                // Step 1: first see if the input is empty or not
                var codeLength = $("#room-code").val().length;

                if (codeLength == 0) {
                  // change to modal later
                  alert("Please enter a code.");
                } else {
                  // send request to server containing code emitted
                  socket.emit("room-code", $("#room-code").val());
                }
              }
            });
          });
        });

        socket.on("generated-url", function(data) {
          console.log("data = " + data);
          $("#invite-menu").html("Share this code with your friend: " + data + "<br>Stay on this page. You will be paired once your friend joins.");
        });

        socket.on("code-validity", function(valid) {
          if (!valid) {
            alert("The code you entered is invalid");
          } else {
            $("#join-menu").removeClass("animated fadeInRight");
            $("#join-menu").addClass("animated fadeOutLeft");

            $("#game-panel").addClass("animated fadeInRight");
          }
        });
      </script>

      <script src="maze.js"></script>
   </body>
</html>